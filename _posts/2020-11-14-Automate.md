---
layout: post
title: Automate the Boring Stuff with Python
categories: Python
tags: [Automate the Boring Stuff with Python] 
excerpt: Automate the Boring Stuff with Python
---

# The shutil Module 
* The *shutil* (or shlell utilities) module has functions to let you copy, move, rename and delete files in your Python programs. To use the *shutil* functions, you will first need to *import shutil*.

# Copying Files and Folders
* The *shutil* module provides functions for copying files, as well as entire folders. 
* Calling *shutil.copy(source, destination)* will copy the file at the path *source* to the folder at the path *destination*. 
* Both *source* and *destination* can be strings or *Path* objects.
* If *destination* is a filename, it will be used as the new name of the copied file. This function returns a string or *Path* object of the copied file. 

```python
import shutil, os
from pathlib import Path
p = Path.home()
shutil.copy(p/'spam.txt', p/'some_folder')
shutil.copy(p/'eggs.txt', p/'some_folder/eggs2.txt')
```
* Note that since a folder was specified as the destination, the original *spam.txt* filename is used for the new, copied file's filename.
* While *shutil.copy()* will copy a single file, *shutil.copytree()* will copy an entire folder and every folder and every file contianed in it. Calling *shutil.copytree(source, destination)* will copy the folder at the path *source*, along with all of its files and subfolders, to the folder at the path *destination*. * The *source* and *destination* parameters are both strings. 
* The function returns a string of the path of the copied folder.
```python
import shutil, os
from pathlib import Path
p = Path.home()
shutil.copytree(p/'spam', p/'spam_backup')
```
* The *shutil.copytree()* call creates a new folder named *spam_backup* with the same content as the original *spam* folder. You have now safely backed up.

# Moving and Renaming Files and Folders
* Calling *shutil.move(source, destination)* will move the file or folder at thepath *source* to the path *destination* and will return a string of the absolute path of the new location.
* If *destination* points to a folder, the *source* file gets moved into *destination* and keeps its current filename. 
* The *destination* path can also specify a filename. 
* Finally, the folders that make up the destination must already exist, or else Python will throw an exception.

# Permanently Deleting Files and Folder 
* You can delete a single file or a single empty folder with functions in the *os* module, whereas to delete a folder and all of its contents, you use the *shutil* module.
* Calling *os.unlink(path)* will delete the file at *path*.
* Calling *os.rmdir(path)* will delete the folder at *path*. This folder must be empty of any files or folders.
* Calling *shutil.rmtree(path)* will remove the folder at *path*, and all files and folders it contains will also be deleted.

* Be careful when using these functions in your programs. It's often a good idea to first run your program with these calls commented out and with *print()* calls added to show the files that would be deleted.

# Safe Deletes with the send2trash Module

